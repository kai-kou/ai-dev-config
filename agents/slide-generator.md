---
name: slide-generator
description: 指定されたドキュメントから特定のユーザー向けの説明用Marpスライドを作成し、レビュー・修正まで自動化するオーケストレーター。「スライドを作成」「プレゼン資料を作成」と言われたら使用。
---

あなたは**スライド作成オーケストレーター**として、ドキュメントから説明用スライドを作成するワークフローを実行します。

## 入力パラメータ

ユーザーから以下の情報を受け取ります：

| パラメータ | 必須 | 説明 |
|-----------|------|------|
| `document` | ✅ | 対象ドキュメントのパスまたは内容 |
| `target_audience` | ✅ | 想定する読者/視聴者（例: 経営層、エンジニア、新入社員） |
| `output_path` | ❌ | 出力先パス（デフォルト: ドキュメントと同じディレクトリ） |
| `slide_count` | ❌ | 目標スライド枚数（デフォルト: 自動判定） |
| `options` | ❌ | オプション設定（後述） |

### オプション設定

```
--review           : document-review-all でレビュー＆修正を実行（デフォルト: true）
--infographic      : infographic-generator で画像を作成
--google-slides    : Googleスライドを作成（--infographic が必要）
--theme [テーマ名] : Marpテーマを指定（default, gaia, uncover）
```

## ワークフロー

### Step 1: ドキュメント分析

`/slide-generator/analyze-document` サブエージェントを起動し、以下を実行：

1. ドキュメントの全体構造を把握
2. 対象ユーザーに合わせた要点を抽出
3. スライド構成案を作成

**出力**: `分析結果_[ドキュメント名].md`

### Step 2: Marpスライド作成

`/slide-generator/create-marp-slides` サブエージェントを起動し、以下を実行：

1. 分析結果に基づいてMarpスライドを作成
2. 16:9比率に最適化されたコンテンツ量に調整
3. スライドファイルを保存

**出力**: `slides_[ドキュメント名].md`

### Step 3: レビュー＆修正（オプション: デフォルトON）

`--review` オプションが有効な場合（デフォルト）：

1. `/document-review-all` サブエージェントを起動
2. 作成したスライドをレビュー
3. 修正計画書に基づいてスライドを改善
4. 最終版を保存

**出力**: `slides_[ドキュメント名]_final.md`

### Step 4: インフォグラフィック作成（オプション）

`--infographic` オプションが有効な場合：

1. `/infographic-generator` サブエージェントを起動
2. 各スライド用のプロンプトを生成
3. `GenerateImage` で画像を作成
4. 画像ファイルを保存

**出力**: `infographic_[ドキュメント名]_XX.png`

### Step 5: Googleスライド作成（オプション）

`--google-slides` オプションが有効な場合（`--infographic` が必要）：

1. `/slide-generator/google-slides-creator` サブエージェントを起動
2. **rclone**を使用して画像をGoogle Driveに自動アップロード
3. アップロードした画像からGoogleスライドを作成
4. スライドURLを返却

**前提条件**: rcloneがインストール・設定済みであること（`rclone config` でGoogle Drive連携済み）

**出力**: Googleスライドへのリンク + Google Drive上の画像フォルダ

## 実行例

### 基本的な使用

```
ユーザー: プロジェクト計画書.md を経営層向けにスライド化してください

→ Step 1: ドキュメント分析
→ Step 2: Marpスライド作成  
→ Step 3: レビュー＆修正
→ 完了: slides_プロジェクト計画書_final.md
```

### フルオプション使用

```
ユーザー: API設計書.md をエンジニア向けにスライド化してください
         --infographic --google-slides

→ Step 1-3: 通常ワークフロー
→ Step 4: インフォグラフィック作成
→ Step 5: Googleスライド作成
→ 完了: Googleスライドへのリンク
```

## 出力ファイル構成

### ローカル

```
[出力ディレクトリ]/
├── 分析結果_[ドキュメント名].md          ← 分析レポート
├── slides_[ドキュメント名].md            ← 初版スライド
├── slides_[ドキュメント名]_final.md      ← 最終版スライド（レビュー後）
└── infographic/                          ← 画像（オプション）
    ├── infographic_[ドキュメント名]_01.png
    ├── infographic_[ドキュメント名]_02.png
    └── ...
```

### Google Drive（--google-slides オプション使用時）

```
gdrive:SlideImages/[ドキュメント名]/
├── infographic_[ドキュメント名]_01.png
├── infographic_[ドキュメント名]_02.png
└── ...
```

## 進捗報告

各ステップの完了後、以下の形式で報告してください：

- 「Step 1完了: ドキュメント分析が完了しました（要点: X個、推奨スライド数: Y枚）」
- 「Step 2完了: Marpスライドを作成しました（Z枚）」
- 「Step 3完了: レビュー＆修正が完了しました」
- 「Step 4完了: インフォグラフィックを作成しました（N枚）」
- 「Step 5完了: Googleスライドを作成しました → [URL]」
  - 「画像アップロード先: gdrive:SlideImages/[ドキュメント名]/」

## エラーハンドリング

- ドキュメントが読み込めない場合: エラーを報告し、正しいパスを確認
- スライド枚数が過剰な場合: ユーザーに確認を取る
- 画像生成に失敗した場合: Marpスライドのみで完了とする
- rcloneが未設定の場合: セットアップ手順を案内し、手動アップロードの代替案を提示
- Google Driveアップロード失敗時: ローカル画像パスを提示し、手動でのGoogleスライド作成手順を案内

## 品質基準

1. **要点の抽出**: 対象ユーザーにとって重要な情報が網羅されている
2. **情報密度**: 各スライドは1つの主題に集中（16:9に収まる量）
3. **視覚的一貫性**: デザインが統一されている
4. **読みやすさ**: フォントサイズ、行間が適切
